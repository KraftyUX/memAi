---
inclusion: always
---

# memAI - AI Agent Memory Integration

## Overview

**memAI** is a persistent memory system that enables AI agents to maintain context across sessions, track decisions, and resume work intelligently. This steering file provides integration guidelines for AI agents working on any project.

**Core Principle**: Record everything significant. The more context preserved, the smarter future sessions become.

## Quick Start

```javascript
import Memai from 'memai';
const memai = new Memai(); // Uses .memai/memory.db by default

// Record a memory
memai.record({
  category: 'implementation',
  action: 'What you did',
  context: 'Why you did it',
  outcome: 'What happened',
  tags: 'relevant,keywords'
});

memai.close();
```

## When to Record (ALWAYS)

### 1. Task Completion (category: `checkpoint`)
Record when completing any task, subtask, or milestone:
```javascript
memai.record({
  category: 'checkpoint',
  phase: 'Feature Development',
  action: 'Completed user authentication module',
  context: 'Implemented OAuth 2.0 with JWT tokens',
  outcome: 'All tests passing, ready for review',
  tags: 'auth,milestone,completed'
});
```

### 2. Decisions (category: `decision`)
Record ALL technical and architectural decisions:
```javascript
memai.recordDecision({
  decision: 'Use PostgreSQL instead of MongoDB',
  rationale: 'Need ACID compliance and complex relational queries',
  alternatives: 'MongoDB (document store), MySQL (older)',
  impact: 'Better data integrity, more complex setup',
  reversible: false
});
```

### 3. Implementation (category: `implementation`)
Record significant code changes:
```javascript
memai.record({
  category: 'implementation',
  phase: 'API Development',
  action: 'Created REST endpoints for user management',
  context: 'CRUD operations with validation and error handling',
  reasoning: 'Required for user management feature',
  outcome: 'Endpoints functional, documented in OpenAPI',
  tags: 'api,rest,users'
});
```

### 4. Issues (category: `issue`)
Record problems immediately when encountered:
```javascript
const issueId = memai.recordIssue({
  severity: 'P1', // P0=critical, P1=high, P2=medium, P3=low
  category: 'bug',
  description: 'Authentication fails on Safari due to cookie SameSite attribute'
});

// When resolved:
memai.resolveIssue(issueId, 'Set SameSite=None with Secure flag');
```

### 5. User Interactions (category: `user-interaction`)
Record approvals, feedback, and clarifications:
```javascript
memai.record({
  category: 'user-interaction',
  action: 'User approved design mockups',
  context: 'Reviewed 3 design options for dashboard',
  outcome: 'Option 2 selected with minor color adjustments',
  tags: 'approval,design,dashboard'
});
```

### 6. Insights (category: `insight`)
Record patterns, best practices, and learnings:
```javascript
memai.addKnowledge({
  topic: 'JWT Token Expiration Strategy',
  content: 'Use 15min access tokens with 7-day refresh tokens. Store refresh tokens in httpOnly cookies.',
  confidence: 0.9,
  source: 'Security audit recommendations',
  tags: 'security,jwt,best-practice'
});
```

### 7. Test Results (category: `validation`)
Record test execution results:
```javascript
memai.recordTestResults({
  testSuite: 'Unit Tests',
  total: 150,
  passed: 148,
  failed: 2,
  skipped: 0,
  durationMs: 2340,
  failureDetails: [
    { test: 'auth validation', error: 'Timeout' }
  ]
});
```

## Session Management

### Start of Session
```javascript
// Generate briefing to understand current state
const briefing = memai.generateBriefing({
  since: Date.now() - (24 * 60 * 60 * 1000), // Last 24 hours
  maxDepth: 50
});

console.log('Current Phase:', briefing.summary.currentPhase);
console.log('Progress:', briefing.summary.currentProgress + '%');
console.log('Active Issues:', briefing.summary.activeIssuesCount);
console.log('Pending Actions:', briefing.summary.pendingActions);
console.log('Blockers:', briefing.summary.blockers);
```

### During Work
- Record decisions as they're made
- Log issues immediately when encountered
- Document significant code changes
- Create checkpoints at logical milestones

### End of Session
```javascript
memai.createCheckpoint({
  phase: 'Current Feature',
  status: 'in-progress', // or 'completed', 'blocked'
  progressPercent: 75,
  pendingActions: ['Write tests', 'Update docs'],
  blockers: ['Waiting for API keys']
});
```

## Best Practices

### ✅ DO

**Be Specific**
```javascript
// Good
memai.record({
  action: 'Fixed authentication timeout on slow networks',
  context: 'Increased timeout from 5s to 30s for mobile users',
  outcome: 'Login success rate improved from 85% to 98%'
});

// Bad
memai.record({
  action: 'Fixed bug'
});
```

**Include Context**
Always provide: what, why, alternatives, outcome

**Use Consistent Tags**
- Technology: `react`, `nodejs`, `postgresql`
- Feature: `auth`, `payments`, `notifications`
- Type: `bugfix`, `feature`, `refactor`

**Link Related Memories**
```javascript
const parentId = memai.record({ /* parent */ });
memai.record({ /* child */, parentId });
```

### ❌ DON'T

- Don't record trivial changes (typo fixes, formatting)
- Don't use vague descriptions
- Don't skip recording decisions
- Don't forget to close connections: `memai.close()`

## Categories Reference

| Category | Use For | Example |
|----------|---------|---------|
| `checkpoint` | Milestones, phase completions | "Completed MVP" |
| `decision` | Technical/architectural choices | "Chose React over Vue" |
| `implementation` | Code changes, features | "Added user dashboard" |
| `issue` | Problems and resolutions | "Fixed memory leak" |
| `validation` | Test results, QA | "All tests passing" |
| `insight` | Patterns, best practices | "Use connection pooling" |
| `user-interaction` | Approvals, feedback | "User approved design" |

## Severity Levels (Issues)

- **P0**: Critical - System down, data loss, security breach
- **P1**: High - Major feature broken, significant impact
- **P2**: Medium - Minor feature issue, workaround available
- **P3**: Low - Cosmetic issue, enhancement request

## Querying Memories

### Get Recent Context
```javascript
const recent = memai.getRecentMemories(20);
```

### Search by Phase
```javascript
const phaseMemories = memai.getPhaseContext('Feature Development');
```

### Search by Tag
```javascript
const authMemories = memai.searchByTag('authentication');
```

### Find Issues
```javascript
const activeIssues = memai.getActiveIssues();
const authIssues = memai.findIssues('authentication');
```

### Get Statistics
```javascript
const stats = memai.getStats();
console.log(`Total memories: ${stats.totalMemories}`);
console.log(`Active issues: ${stats.activeIssues}`);
console.log(`Decisions tracked: ${stats.totalDecisions}`);
```

## Export & Reporting

```javascript
// Export to JSON (backup)
memai.exportToJson('./backup.json');

// Export to Markdown (report)
memai.exportToMarkdown('./report.md');
```

## CLI Usage

```bash
# Initialize database
memai init

# View statistics
memai stats

# Recent memories
memai recent 20

# Search
memai search "authentication"

# Generate briefing
memai briefing 24

# Export report
memai export markdown report.md

# Launch dashboard
memai dashboard
```

## Integration Patterns

### Express.js Middleware
```javascript
app.use((req, res, next) => {
  const start = Date.now();
  res.on('finish', () => {
    memai.record({
      category: 'user-interaction',
      action: `${req.method} ${req.path}`,
      context: `Status: ${res.statusCode}, Duration: ${Date.now() - start}ms`,
      tags: `api,${req.method.toLowerCase()}`
    });
  });
  next();
});
```

### Error Tracking
```javascript
process.on('uncaughtException', (error) => {
  memai.recordIssue({
    severity: 'P0',
    category: 'error',
    description: `Uncaught exception: ${error.message}\n${error.stack}`
  });
});
```

### Git Hooks
```bash
# .git/hooks/post-commit
#!/bin/bash
COMMIT_MSG=$(git log -1 --pretty=%B)
node -e "
import Memai from 'memai';
const memai = new Memai();
memai.record({
  category: 'checkpoint',
  action: 'Git commit: $COMMIT_MSG',
  tags: 'git,commit'
});
memai.close();
"
```

## Why memAI Over Markdown?

| Feature | Markdown | memAI |
|---------|----------|-------|
| Query Speed | O(n) grep | O(log n) SQL |
| Relationships | Manual links | Foreign keys |
| Time-based Queries | Manual parsing | Built-in |
| Analytics | Manual | Automatic |
| Resume Context | Read entire file | Query last N |
| Pattern Recognition | Manual | Queryable |
| Issue Tracking | Manual | Built-in |

## Advanced: Knowledge Base

Build a reusable knowledge base:

```javascript
// Add knowledge
memai.addKnowledge({
  topic: 'Database Connection Pooling',
  content: 'Use pool size of 10-20 for typical workloads. Monitor with connection metrics.',
  confidence: 0.9,
  source: 'Production optimization',
  tags: 'database,performance,best-practice'
});

// Query knowledge
const knowledge = memai.getTopKnowledge(10);
knowledge.forEach(k => {
  console.log(`${k.topic}: ${k.content}`);
});
```

## Performance Tips

1. **Batch Operations**: Record multiple memories in one session
2. **Use Transactions**: For related memories
3. **Close Connections**: Always call `memai.close()`
4. **Regular Exports**: Backup data periodically
5. **Archive Old Data**: Export and clean data older than 6 months

## Troubleshooting

### Database Locked
```javascript
// Ensure you close connections
memai.close();
```

### Memory Growth
```javascript
// Export and archive old data
memai.exportToJson(`archive-${Date.now()}.json`);
```

### Query Performance
```javascript
// Use specific queries with limits
memai.getRecentMemories(20); // Instead of 1000
```

## Example: Complete Session

```javascript
import Memai from 'memai';

const memai = new Memai();

// Start: Get context
const briefing = memai.generateBriefing({ since: Date.now() - 86400000 });
console.log('Resuming:', briefing.summary);

// Work: Record decision
memai.recordDecision({
  decision: 'Use Redis for session storage',
  rationale: 'Fast, distributed, built-in expiration',
  alternatives: 'In-memory (not distributed), Database (slower)',
  impact: 'Better performance and scalability',
  reversible: true
});

// Work: Record implementation
const memoryId = memai.record({
  category: 'implementation',
  phase: 'Session Management',
  action: 'Integrated Redis for session storage',
  context: 'Replaced in-memory sessions with Redis',
  outcome: 'Sessions persist across server restarts',
  tags: 'redis,sessions,backend'
});

// Work: Record issue
const issueId = memai.recordIssue({
  severity: 'P2',
  category: 'config',
  description: 'Redis connection string needs environment variable'
});

memai.resolveIssue(issueId, 'Added REDIS_URL to .env.example');

// End: Create checkpoint
memai.createCheckpoint({
  phase: 'Session Management',
  status: 'completed',
  progressPercent: 100,
  pendingActions: ['Deploy to staging', 'Monitor performance'],
  blockers: []
});

// Export report
memai.exportToMarkdown('./session-report.md');

// Close
memai.close();

console.log('✅ Session recorded in memAI');
```

---

## Installation

```bash
npm install memai
```

## Documentation

- **API Reference**: https://github.com/kraftyux/memai/blob/main/docs/API.md
- **CLI Reference**: https://github.com/kraftyux/memai/blob/main/docs/CLI.md
- **Examples**: https://github.com/kraftyux/memai/blob/main/docs/EXAMPLES.md

---

**Remember**: Every decision, issue, and insight you record makes future work easier. The AI agent's memory is only as good as what you feed it.
